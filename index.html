<!DOCTYPE html>
<html lang="vi">
<head>
  <meta charset="UTF-8">
  <title>FB UID Checker & Theo D√µi</title>
  <style>
    body { font-family: Arial; background: #f0f2f5; margin: 20px; }
    h2 { color: #1877f2; }
    input, button { padding: 8px; margin: 5px 0; width: 100%; }
    .section { background: white; padding: 15px; margin-bottom: 20px; border-radius: 8px; box-shadow: 0 2px 5px #ccc; }
    #results, #list { margin-top: 10px; }
    .uid-item { padding: 10px; border-bottom: 1px solid #eee; }
    .live { color: green; font-weight: bold; }
    .die { color: red; font-weight: bold; }
  </style>
</head>
<body>

  <h2>‚úÖ Ki·ªÉm tra & Theo d√µi UID Facebook</h2>

  <div class="section">
    <h3>üîç Check nhanh UID ho·∫∑c Link Facebook</h3>
    <input id="quickInput" placeholder="Nh·∫≠p UID ho·∫∑c link Facebook">
    <button onclick="quickCheck()">Ki·ªÉm tra</button>
    <div id="results"></div>
  </div>

  <div class="section">
    <h3>üìå L∆∞u UID ƒë·ªÉ theo d√µi</h3>
    <input id="trackInput" placeholder="Nh·∫≠p UID ho·∫∑c link Facebook">
    <input id="trackName" placeholder="ƒê·∫∑t t√™n cho UID (VD: A, Clone 1)">
    <button onclick="saveUID()">L∆∞u & Theo d√µi</button>
    <div id="trackMsg"></div>
  </div>

  <div class="section">
    <h3>üìã Danh s√°ch ƒëang theo d√µi</h3>
    <div id="list"></div>
  </div>

  <script>
    const checkLive = async (uid) => {
      try {
        const res = await fetch("https://graph.facebook.com/" + uid + "?fields=id&method=get&format=json");
        return res.status === 200;
      } catch {
        return false;
      }
    };

    const extractUID = (input) => {
      input = input.trim();
      if (/^\d+$/.test(input)) return input;
      const match = input.match(/facebook\.com\/(?:profile\.php\?id=)?([\w.]+)/i);
      if (match) return match[1];
      return input;
    };

    const quickCheck = async () => {
      const input = document.getElementById("quickInput").value;
      const uid = extractUID(input);
      const isLive = await checkLive(uid);
      document.getElementById("results").innerHTML = isLive
        ? `<p class='live'>‚úÖ UID ${uid} LIVE</p>`
        : `<p class='die'>‚ùå UID ${uid} DIE</p>`;
    };

    const saveUID = async () => {
      const input = document.getElementById("trackInput").value;
      const name = document.getElementById("trackName").value.trim();
      const uid = extractUID(input);
      if (!uid || !name) return alert("Vui l√≤ng nh·∫≠p ƒë·ªß UID v√† t√™n g√°n!");

      const isLive = await checkLive(uid);
      if (!isLive) {
        document.getElementById("trackMsg").innerHTML = `<p class="die">‚ùå UID n√†y kh√¥ng t·ªìn t·∫°i. Kh√¥ng l∆∞u.</p>`;
        return;
      }

      let list = JSON.parse(localStorage.getItem("uidList") || "[]");
      if (list.find(item => item.uid === uid)) {
        document.getElementById("trackMsg").innerHTML = `<p class="live">‚úÖ UID ƒë√£ c√≥ trong danh s√°ch.</p>`;
        return;
      }

      list.push({ uid, name, status: "LIVE" });
      localStorage.setItem("uidList", JSON.stringify(list));
      document.getElementById("trackMsg").innerHTML = `<p class="live">‚úÖ ƒê√£ l∆∞u UID & b·∫Øt ƒë·∫ßu theo d√µi.</p>`;
      renderList();
    };

    const renderList = () => {
      let list = JSON.parse(localStorage.getItem("uidList") || "[]");
      const box = document.getElementById("list");
      box.innerHTML = "";
      if (list.length === 0) {
        box.innerHTML = "<i>Ch∆∞a theo d√µi UID n√†o.</i>";
        return;
      }
      list.forEach(item => {
        box.innerHTML += `
          <div class="uid-item">
            <b>${item.name}</b> - ${item.uid} 
            <span class="${item.status === 'LIVE' ? 'live' : 'die'}">[${item.status}]</span>
          </div>`;
      });
    };

    const autoCheck = async () => {
      let list = JSON.parse(localStorage.getItem("uidList") || "[]");
      let changed = false;
      for (let item of list) {
        if (item.status === "DIE") continue;
        const isLive = await checkLive(item.uid);
        const newStatus = isLive ? "LIVE" : "DIE";
        if (newStatus !== item.status) {
          alert(`‚ö†Ô∏è UID [${item.name}] ƒë√£ chuy·ªÉn t·ª´ ${item.status} ‚Üí ${newStatus}`);
          item.status = newStatus;
          changed = true;
        }
      }
      if (changed) {
        localStorage.setItem("uidList", JSON.stringify(list));
        renderList();
      }
    };

    // Kh·ªüi ƒë·ªông
    renderList();
    setInterval(autoCheck, 60000); // m·ªói 60 gi√¢y
  </script>

</body>
</html>
